The script uses samtools to subsample existing RNA/RFP BAM files into 3 groups:

* **GROUP 1** RNA + RFP: this corresponds to concordant differences in expression that should be detectable in both RNA and RFP; 

* **GROUP 2** RFP only: those are translationally induced differences which are exclusive to RFP;

* **GROUP 3** RNA only: this corresponds to "buffered" genes that do not exhibit variation on the translational level, but that should be detected as "differentially transcribed". 

Each file is treated as a replicate from the same condition, in particular subsampling is based on reference names of one of the files, assuming that they all have the same '@SQ SN' header. The script then generates two conditions (condition1 and condition 2) from this data. 

Suppose we provide the following files: 

```
rna_file_rep1.bam
rfp_file_rep1.bam. 
```

The script will generate the following files:

```
rna_file_rep1.cond1.bam, rfp_file_rep1.cond1.bam
rna_file_rep1.cond2.bam, rfp_file_rep1.cond2.bam
```

The proportion of genes in each group as well as the fraction of templates/pairs to be kept is specified. In addition, different proportions for up and down can be specified in each group. Suppose we have the following:


Condition 1 (RFP)
| ... | SN1 | SN2 | SN3 | SN4 | SN5 | SN6 | ... |
| --- | --- | --- | --- | --- | --- | --- | --- |
| ... | &downarrow; | SN2 | &downarrow; | SN4 | SN5 | SN6 | ... |

Condition 2 (RFP)
| ... | SN1 | SN2 | SN3 | SN4 | SN5 | SN6 | ... |
| --- | --- | --- | --- | --- | --- | --- | --- |
| ... | SN1 | &downarrow; | SN3 | &downarrow; | SN5 | SN6 | ... |

Condition 1 (RNA)
| ... | SN1 | SN2 | SN3 | SN4 | SN5 | SN6 | ... |
| --- | --- | --- | --- | --- | --- | --- | --- |
| ... | &downarrow; | SN2 | SN3 | SN4 | &downarrow; | SN6 | ... |

Condition 2 (RNA)
| ... | SN1 | SN2 | SN3 | SN4 | SN5 | SN6 | ... |
| --- | --- | --- | --- | --- | --- | --- | --- |
| ... | SN1 | &downarrow; | SN3 | SN4 | SN5 | &downarrow; | ... |


SN1 and SN2 should appear as up- and down-regulated, respectively, for both RFP and RNA **GROUP 1**, when comparing both conditions (conditon2 - condition 1). SN3 and SN4 would appear as up- and down-regulated, respectively, for RFP only, thus will belong to **GROUP 2**. Similarly, SN5 and SN6 would belong to **GROUP 3**.

The different *lists* generated by the script contain the selected regions belonging to each groups (1, 2, and 3), where subsampling is performed as schematised above. 

Finally, the resulting BAM files for each replicate are again downsampled differently (using a fixed proportion) between conditions to introduce some noise, since they are generated from the same file. The final simulated count data will reflect this, but not necessarily the different *lists* (templates are affected differently between RFP and RNA by samtools when sampling from the full list without filtering), however this is relatively easy to adjust afterwards, given a known threshold. 
